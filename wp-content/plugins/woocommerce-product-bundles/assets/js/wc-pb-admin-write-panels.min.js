jQuery(function(a){function b(){var a={formatMatches:function(a){return 1===a?wc_bundles_admin_params.i18n_matches_1:wc_bundles_admin_params.i18n_matches_n.replace("%qty%",a)},formatNoMatches:function(){return wc_bundles_admin_params.i18n_no_matches},formatAjaxError:function(a,b,c){return wc_bundles_admin_params.i18n_ajax_error},formatInputTooShort:function(a,b){var c=b-a.length;return 1===c?wc_bundles_admin_params.i18n_input_too_short_1:wc_bundles_admin_params.i18n_input_too_short_n.replace("%qty%",c)},formatInputTooLong:function(a,b){var c=a.length-b;return 1===c?wc_bundles_admin_params.i18n_input_too_long_1:wc_bundles_admin_params.i18n_input_too_long_n.replace("%qty%",c)},formatSelectionTooBig:function(a){return 1===a?wc_bundles_admin_params.i18n_selection_too_long_1:wc_bundles_admin_params.i18n_selection_too_long_n.replace("%qty%",a)},formatLoadMore:function(a){return wc_bundles_admin_params.i18n_load_more},formatSearching:function(){return wc_bundles_admin_params.i18n_searching}};return a}function c(){a(".wc-bundled-items .wc-bundled-item").each(function(b,c){a(".item_index",c).text(b+1),a(".item_menu_order",c).val(b)})}function d(b){var c=["product","cart","order"],d=!1;a.each(c,function(a,c){b.find("input.visibility_"+c).is(":checked")?(b.find("input.price_visibility_"+c).css("opacity",1),d=!0):b.find("input.price_visibility_"+c).css("opacity",.5)})}function e(){a(".wc-bundled-items").on("change",".priced_individually input",function(){a(this).is(":checked")?(a(this).closest("div.item-data").find(".discount").show(),a(this).closest("div.item-data").find(".price_visibility").show()):(a(this).closest("div.item-data").find(".discount").hide(),a(this).closest("div.item-data").find(".price_visibility").hide())}).on("change",".override_variations input",function(){a(this).is(":checked")?a(this).closest("div.item-data").find("div.allowed_variations").show():a(this).closest("div.item-data").find("div.allowed_variations").hide()}).on("change",".override_default_variation_attributes input",function(){a(this).is(":checked")?a(this).closest("div.item-data").find("div.default_variation_attributes").show():a(this).closest("div.item-data").find("div.default_variation_attributes").hide()}).on("change",".override_title input",function(){a(this).is(":checked")?a(this).closest("div.item-data").find("div.custom_title").show():a(this).closest("div.item-data").find("div.custom_title").hide()}).on("change",".override_description input",function(){a(this).is(":checked")?a(this).closest("div.item-data").find("div.custom_description").show():a(this).closest("div.item-data").find("div.custom_description").hide()}).on("change","input.visibility_product",function(){a(this).is(":checked")?(a(this).closest("div.item-data").find(".override_title, .override_description, .hide_thumbnail").show(),a(this).closest("div.item-data").find(".override_title input").change(),a(this).closest("div.item-data").find(".override_description input").change()):a(this).closest("div.item-data").find(".override_title, .custom_title, .override_description, .custom_description, .hide_thumbnail").hide(),d(a(this).closest("div.item-data"))}).on("change","input.visibility_cart, input.visibility_order",function(){d(a(this).closest("div.item-data"))}),a(".wc-bundled-items .priced_individually input").change(),a(".wc-bundled-items .override_variations input").change(),a(".wc-bundled-items .override_default_variation_attributes input").change(),a(".wc-bundled-items .override_title input").change(),a(".wc-bundled-items .override_description input").change(),a(".wc-bundled-items input.visibility_product").change();var b=a(".wc-bundled-items").find(".wc-bundled-item").get();b.sort(function(b,c){var d=parseInt(a(b).attr("rel")),e=parseInt(a(c).attr("rel"));return d<e?-1:d>e?1:0}),a(b).each(function(b,c){a(".wc-bundled-items").append(c)}),a(".wc-bundled-items").sortable({items:".wc-bundled-item",cursor:"move",axis:"y",handle:"h3",scrollSensitivity:40,forcePlaceholderSize:!0,helper:"clone",opacity:.65,placeholder:"wc-metabox-sortable-placeholder",start:function(a,b){b.item.css("background-color","#f6f6f6")},stop:function(a,b){b.item.removeAttr("style"),c()}}),c(),a(".wc-bundle-metaboxes-wrapper",f).on("click","button.remove_row",function(){var b=a(this).closest(".wc-bundled-item");b.find("*").off(),b.remove(),c()}),a(".expand_all",f).click(function(){return a(this).closest(".wc-metaboxes-wrapper").find(".wc-metabox > .item-data").show(),!1}),a(".close_all",f).click(function(){return a(this).closest(".wc-metaboxes-wrapper").find(".wc-metabox > .item-data").hide(),!1})}var f=a("#bundled_product_data"),g=a("#bundled_product",f);a.fn.wc_bundles_select2=function(){a(this).find(":input.wc-enhanced-select").filter(":not(.enhanced)").each(function(){var c=a.extend({minimumResultsForSearch:10,allowClear:!!a(this).data("allow_clear"),placeholder:a(this).data("placeholder")},b());a(this).select2(c).addClass("enhanced")})},a(".bundle_stock_msg").appendTo("._manage_stock_field .description"),a("#_sold_individually").closest(".form-field").addClass("hide_if_bundle"),a("#linked_product_data .grouping.show_if_simple, #linked_product_data .form-field.show_if_grouped").addClass("hide_if_bundle"),a(".show_if_simple:not(.hide_if_bundle)").addClass("show_if_bundle"),a("body").on("woocommerce-product-type-change",function(b,c,d){"bundle"===c&&(a(".show_if_external").hide(),a(".show_if_bundle").show(),a("input#_manage_stock").change(),a("#_nyp").change())}),a("select#product-type").change(),a("input#_downloadable").change(function(){a("select#product-type").change()}),e(),a("#wc-bundle-metaboxes-wrapper-inner").on("click",".subsubsub a",function(){a(this).closest(".subsubsub").find("a").removeClass("current"),a(this).addClass("current"),a(this).closest(".wc-bundled-item").find(".options_group").addClass("options_group_hidden");var b=a(this).data("tab");return a(this).closest(".wc-bundled-item").find(".options_group_"+b).removeClass("options_group_hidden"),!1});var h=a(".wc-bundled-items .wc-bundled-item",f).size(),i={};i="yes"==wc_bundles_admin_params.is_wc_version_gte_2_3?{message:null,overlayCSS:{background:"#fff",opacity:.6}}:{message:null,overlayCSS:{background:"#fff url("+woocommerce_admin_meta_boxes.plugin_url+"/assets/images/ajax-loader.gif) no-repeat center",opacity:.6}},f.on("click","button.add_bundled_product",function(){var b=g.val();if(!b>0)return"yes"===wc_bundles_admin_params.is_wc_version_gte_2_3?a(".bundled_product_selector .wc-product-search",f).select2("open"):a(".bundled_product_selector .ajax_chosen_select_products",f).trigger("chosen:open.chosen"),!1;"yes"===wc_bundles_admin_params.is_wc_version_gte_2_3&&a(".bundled_product_selector .wc-product-search",f).select2("val",""),f.block(i),h++;var e={action:"woocommerce_add_bundled_product",post_id:woocommerce_admin_meta_boxes.post_id,id:h,product_id:b,security:wc_bundles_admin_params.add_bundled_product_nonce};return a.post(woocommerce_admin_meta_boxes.ajax_url,e,function(b){if(""!==b.markup){a(".wc-bundled-items",f).append(b.markup),c();var e=a(".wc-bundled-items .wc-bundled-item",f).last();"yes"==wc_bundles_admin_params.is_wc_version_gte_2_3?e.wc_bundles_select2():e.find(".chosen_select").chosen(),e.find(".override_variations input").change(),e.find(".override_default_variation_attributes input").change(),e.find(".override_title input").change(),e.find(".override_description input").change(),d(e),e.find(".woocommerce-help-tip").tipTip({attribute:"data-tip",fadeIn:50,fadeOut:50,delay:200}),f.trigger("wc-bundles-added-bundled-product"),e.find(".wc-product-search").length>0&&a(document.body).trigger("wc-enhanced-select-init")}else""!==b.message&&window.alert(b.message);f.unblock()}),!1})});